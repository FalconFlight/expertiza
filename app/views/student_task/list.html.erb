<h1>Assignments</h1>
<br/>
<div class="flash_note">To begin, click on an assignment from the list below or <%= link_to 'click here', :controller => 'publishing', :action => 'view' %> to set <b>publishing rights</b> for your work.</div>
<br/>
<table class="listing" cellpadding=2>
  <tr>
	<th>&nbsp;</th>
	<th>Assignment</th>
	<th>Course</th>
	<th>Topic</th>
	<th>Current Stage</th>
	<th>Stage Deadline</th>
	<th>Publishing Rights</th>
   </tr>
	
  <% for participant in @participants %>
    <% if participant.assignment != nil %>
      <tr class="listingRow">
	    <td>&nbsp;</td>
	    <td><%= link_to participant.assignment.name, :action => 'view', :id => participant %></td>
	    <td><%= participant.get_course_string %></td>
	    <td><%= participant.get_topic_string %></td>
		<%if participant.assignment.get_current_stage(participant.topic_id)== "switch_topics"%>
		<td>submission</td>
		<%else%>
        <td><%= participant.assignment.get_current_stage(participant.topic_id) %></td>
		<%end%>
	    <td><%= participant.assignment.get_stage_deadline(participant.topic_id) %></td>
	    <td align=center><%if participant.permission_granted %>granted<% else %>denied<% end %></td>
      </tr>
    <% end %>
  <% end %>
</table>
<br/>

<h1>Tasks</h1>

<table class="listing" cellpadding=2>
  <tr>
	<th>&nbsp;</th>
	<th>Assignment</th>
	<th>Course</th>
	<th>Topic</th>
	<th>Stage</th>
	<th>Stage Deadline</th>
	<th>Needs Attention</th>
   </tr>
	
  <% for task in @task_list %>
    <% if task["name"] != nil %>
      <tr class="listingRow">
	    <td>&nbsp;</td>
	    <td><%= task["name"] %></td>
	    <td><%= task["course"] %></td>
	    <td><%= task["topic"] %></td>
	    <% if (task["link_info"]) %>
           <% if (task["deadline_type"].include? 'submission') %>
        <td><%= link_to task["deadline_type"], {:controller => 'submitted_content', :action => 'edit', :id => task["link_info"]} %></td>
           <% elsif (task["deadline_type"].include? 'review') %>
        <td><%= link_to task["deadline_type"], {:controller => 'response', :action => (task["link_info"].response ? "edit" : "new"), :id => task["link_info"]} %></td>
           <% end %>
        <% else %>
        <td><%= task["deadline_type"] %></td>
        <% end %>
	    <td><%= task["due_at"] %></td>
	    <td><%= task["needs_attention"] %></td>
      </tr>
    <% end %>
  <% end %>
</table>
