<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
		<title>Untitled Document</title>
	</head>
	<body>
		
		<% @title = 'View Document Info' %>
<p><%= button_to_function 'Edit', "window.location = '#{url_for(:action => :edit, :doc_id => @document.id)}'" %> 
<p><strong>Title:</strong> <%= @document.title %></p>
<p><strong>Author:</strong> <%= @document.author_name %> (<%= @document.author_email %>)</p>
<p><strong>Type:</strong> <%= @document.type %></p>


<h3>Folders</h3>
<% form_for '', :url => {:action => :update_doc_folder, :doc_id => @document.id, :do => 'add'} do %>
<p><%= select_tag :folder, options_for_select(@account.folders.select{|f| !@document.folders.include?(f.title) }.collect{|f| [f.title, f.id]}) %> <%= submit_tag 'Add to Folder' %></p>
<% end %>
<ul>
	<% @document.folders.each do |f| %>
		<li><%= f %> (<%= link_to 'X', {:action => :update_doc_folder, :doc_id => @document.id, :do => 'delete', :folder => f} %>)</li>
	<% end %>
</ul>
<h3>Download As:</h3>
<%= render :partial => "document_download" %>

<h3>Permissions</h3>
<strong>Add User</strong>
<% form_for '', :url => {:action => :add_user, :doc_id => @document.id, :id => '1'} do %>
<p>Email: <%= text_field_tag :user %> Role: <%= select_tag :role, options_for_select(['writer', 'reader']) %> <%= submit_tag 'Save' %>
<% end %>
<ul>
<% @document.access_rules.each do |a| %>
	<li><%= a.user %> - <%= a.role %> <% if a.role != 'owner' %>(<%= link_to 'X', {:action => :remove_user, :user => a.user, :doc_id => @document.id, :id => '1'}, :confirm => 'Are you sure you want to remove this user?' %>)<% end %></li>
<% end %>
</ul>
		
	</body>
</html>
